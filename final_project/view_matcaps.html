<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="../style.css">
    <link rel="stylesheet" href="./style_final_project.css">
    <link rel="shortcut icon" href="#">
  </head>


  <script id ="vertex-shader" type="x-shader/x-vertex">
  // precision mediump float;
  // attribute vec4 a_Position;
  // attribute vec3 a_Normal;
  // attribute vec4 a_Color;
  // varying vec4 v_Color;
  //
  // uniform vec4 lightPosition;
  //
  // uniform vec4 ambientProduct;
  // uniform vec4 diffuseProduct;
  // uniform vec4 specularProduct;
  // uniform float shininess;
  //
  // uniform mat4 m; // model matrix in shader
  // uniform mat4 v; // view matrix in shader
  // uniform mat4 p; // projection matrix in shader
  precision mediump float;
  attribute vec3 position;
  attribute vec3 normal;
  varying vec3 vNormal;

  uniform mat4 projection;
  uniform mat4 view;
  uniform mat4 world;


  void main() {
    // vec3 pos = (v * m * a_Position).xyz;
    // vec3 light = (v * lightPosition).xyz;
    // vec3 L;
    //
    // // check for directional light
    // if (lightPosition.w == 0.0){
    //   L = normalize(light);
    // }
    // else{
    //   L = normalize(light - pos);
    // }
    //
    // vec3 E = -normalize(pos);
    // vec3 H = L + E;
    // vec3 N = normalize((v * m * vec4(a_Normal, 0.0)).xyz);
    //
    // vec4 ambient = ambientProduct;
    // vec4 diffuse = max(dot(normalize(L), normalize(N)), 0.0) * diffuseProduct;
    // vec4 specular = pow(max(dot(normalize(N), normalize(H)), 0.0), shininess) * specularProduct;
    //
    // if(dot(normalize(L), normalize(N)) < 0.0){
    //    specular = vec4(0.0, 0.0, 0.0, 1.0);
    // }
    //
    // v_Color = ambient + diffuse + specular;
    // v_Color.a = 1.0;
    //
    // gl_Position = p * v * m * a_Position;
    gl_Position = projection * view * world * vec4(position, 1.0);
    vNormal = normalize(normal);
  }
  </script>

  <script id="fragment-shader" type="x-shader/x-fragment">
    // precision mediump float;
    // varying vec4 v_Color;
    precision mediump float;
    uniform mat4 view;
    uniform mat4 projection;

    uniform sampler2D matcapTexture;
    varying vec3 vNormal;


  void main() {
    // gl_FragColor = v_Color;
    vec2 muv = vec2(view * vec4(normalize(vNormal), 0))*0.5+vec2(0.5,0.5);
    // read texture inverting Y value
    gl_FragColor = texture2D(matcapTexture, vec2(muv.x, 1.0-muv.y));
  }
  </script>

  <script type ="text/javascript" src="../angelCommon/webgl-utils.js"></script>
  <script type ="text/javascript" src="../angelCommon/initShaders.js"></script>
  <script type ="text/javascript" src="../angelCommon/MV.js"></script>
  <script src="view_matcaps.js"></script>
  <script type="text/javascript" src="../common/OBJParser.js"></script>

  <body>
    <h1>View MatCap on a 3D object</h1>

    <div class="container">
      <canvas id="gl-canvas" width="512" height="512"></canvas>

      <div class="menus">

        <p> 3D objects: </p>
        <select id="objectsMenu" size="3">
          <option value="0" selected>Monkey</option>
          <option value="1">Donut</option>
          <option value="2">B</option>
        </select>

        <p> MatCaps: </p>
        <select id="matcapsMenu" size="4">
          <option value="0" selected>Green gel</option>
          <option value="1">Darker red</option>
          <option value="2">Blue sky</option>
          <option value="3">Green glass</option>
        </select>
      </div>
    </div>


    <div class="loadMatcapOption">
      <label for="myMatcap">Load MatCap:</label>
      <input type="file" id="myMatcap" name="myMatcap">

      <div class="divMatcapImg">
        <img id="myImgMatcap">
      </div>
    </div>


  </body>
</html>
